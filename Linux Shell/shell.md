# chap 1

0. 脚本执行方式：```1): bash xxx.sh;       2): ./xxx.sh```

1. ```#!```定义解释该脚本所用的解释器；```#```注释

2. ```.bashrc```交互式shell初始化脚本文件；```.bash_profile```登录shell初始化脚本文件；```.bash_history```历史记录

3. 打印彩色文本(30+)```echo -e "\e[1;31m This is red text \e[0m```；设置彩色背景(40+)```\e[1;42m```

4. echo使用单引号时，变量不会被拓展```echo '$var'    ->      $var``` 

5. export命令声明将由子进程继承的变量

6. 环境变量

    1. ```PS1```修改Bash提示字符串

    2. ```PS4```设置显示每行的行号

    3. ```_DEBUG```

    4. ```$?```保存返回值（退出状态）

7. 数学运算：```let;    (());    [];     expr;   bc```；```bc```是用于数学运算的工具

8. 使用```>```重定向到文件，使用```>>```追加到文件,```2>```文件描述符 + 重定向

9. ```tee```接收来自```stdin```的数据，将```stdout```写入文件，同时将一份副本作为后续命令的```stdin```

10. ```/dec/null```（黑洞）：丢弃接收到的任何数据

11. ```exec```创建新的文件描述符

12. 数组和关联数组，关联数组（字典）要先用```declare```声明

13. 别名```alias; unalias```;```    \cmd```忽略别名

14. 采集终端信息：```tput;  stty```

15. ```date```日期及延时

16. ```seq 0 40```生成一系列数字

17. 调试脚本
    
    1. ```bash -x xxx.sh```启用跟踪调试功能

    2. ```set -x; set +x; set -v; set +v```

    3. ```#!/bin/bash -xv```

    4. ```_DEBUG```可以启用或禁止调试及生成特定形式的信息

18. 函数和参数

    1. 定义

        ```sh
        function fname()
        {
            statements;
        }
        fname()
        {
            statements;
        }
        fname () {statements;}
        ```

    2. 访问函数
        
        ```sh
        fname arg1 arg2;
        # $0:脚本名称
        # $n:第n个参数
        # $@:以列表形式打印所有参数
        # $*:打印所有参数，但所有参数被当作单个字符串
        # shift可以将参数一次向左移动一个位置
        ```

    3. 函数可以递归，可以导出

19. ```(ls | cat -n)```()定义子shell，子shell执行不影响当前shell

20. ```read [-nsptd]```读取字符

21. 内部字符分隔符：默认```IFS=“ ” ```，可以更改```data="name, gender";     for item in $data"```

22. 比较与测试

    1. ```if```语句

        ```sh
        if cond;
        then    
            cmds;
        else
            cmds;
        fi
        ```

    2. 比较条件```[ condition ]```（condition前后要有空格）

        ```[ condition ] && action;```，```&&```逻辑与 **（运算符）**，条件为真，执行action

        ```[ condition ] || action;```， ```||```逻辑或 **（运算符）**,条件为假，执行action

        ```[ $var1 -ne 0 -a $var2 -gt 2 ]```, ```-a```逻辑与 **（操作符）**

        ```[ $var1 -ne 0 -o $var2 -gt 2 ]```, ```-o```逻辑或 **（操作符）**

    3. 文件系统测试```[ -arg $var ]```

        | -f | -x | -d | -e | -c | -b | -w | -r | -L |
        | ----- | ----- | ----- | ----- | ----- | ----- | ----- | ----- | ----- |
        |文件|可执行|目录|文件存在|字符设备文件|块设备文件|可写|可读|符号链接|

    4. 可以用```test```来测试条件，可以避免括号，但test是外部程序，需要衍生出对应的进程，```[]```是内部函数，效率更高

        ```if [ $var -eq 0 ]; then echo "True"; fi```

        ```if test $var -eq 0; then echo "True"; fi```

23. 可以使用配置文件定制bash，登录时 / 启动交互式shell / 调用shell处理脚本调用不同的配置文件

# chap 2

1. ```cat [-s -T -n]```

2. ```script;   scriptreplay;``` 

3.  ```find```
    ```sh
    find [-print -print0]           # 设置不同的分隔符
         [-path]                    # 限制匹配路径
         [-iname]                   # 不区分大小写
         [-regex]                   # 基于正则表达式限制文件路径
         [!]                        # 否定参数
         [-L]                       # 遍历时进入符号链接
         [-mindepth -maxdepth]      # 限制深度，先限制深度再匹配效率更高
         [-type]                    # 根据文件类型搜索
         [-atime -mtime -ctime]     # 根据文件时间戳搜索（天）
         [-amin -mmin -cmin]        # （分钟）
         [-size]                    # 根据文件大小搜索
         [-perm 644]                # 根据文件权限搜索
         [-user jbl]                # 根据user搜索
         [-delete -exec]            # 执行相应操作
         [-name '.git' -prune]      # 跳过指定目录
    ```

4. ```xargs```重新格式化stdin接收到的数据，再将其作为参数提供给指定命令
    ```sh
     [-n]       # 按指定数量重新划分
     [-d]       # 改变分隔符
     [-I]       # 指定替换字符串
     [-0]       # 用NULL作分隔符
     ```
5. ```tr```(translate)
    ```sh
    tr  [option] set1 set2
        [-d]                    # 指定删除的字符集合
        [-c]                    # 使用补集
        [-s]                    # 压缩字符
    tr '[:lower:]' '[:upper:]'  # 使用字符集合
    ```

6. 检验和
    ```sh
    # 单向散列算法
     md5sum; sha1sum;       # [-c]核实（检验文件）
     md5deep; sha1deep;     # 检验目录
     ```

7. 加密算法，可以无损地重构数据```crypt; gpg; base64```

8. ```sort + uniq```

9. ```mktemp```为临时文件或目录命名

10. ```split```分割文件；```csplit```基于上下文分割文件（如分割日志）

11. ```%; %%; （从右向左匹配， 非贪婪/贪婪）  #; ##; （从左向右匹配） ```
    
12. ```rename```

13. ```aspell```检查某个单词是否在词典中

14. ```look```显示出以特定字符串起始的行

15. ```&```令shell将命令置于后台并继续执行

16. ```$!```获得进程PID 

# chap 3

1. 可以使用```dd```命令生成任意大小的文件

2. ```comm```可用于比较两个已排序的文件

3. 可以根据文件大小和检验和查找重复文件

4. 粘滞位：只有创建该目录的用户才能删除目录中的文件（可用于/tmp）

5. 权限：```+s(setuid)```，允许可执行文件以其拥有者的权限来执行；```+t```设置粘滞位

6. 设置不可修改文件（需要文件系统支持）：```chattr +i file```

7. ```touch```创建空白文件

8. 文件也可以作为文件系统挂载

9. ```diff```可以生成两个文件之间的差异对比；```patch```将变更应用于其中一个文件

10. ```tail -f```可用于监控文件更新

11. 快速定位目录```pushd; dirs; popd; cd -;```

12.  ```wc```统计文件信息


