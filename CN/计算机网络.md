# 第一章 概论

1. 构成

    1. 节点：主机及其运行的应用程序、路由器、交换机

    2. 边：通信链路（接入网链路、主干链路）

    3. 协议：控制发送、接收消息

2. 网络结构

    1. 网络边缘：主机、应用程序

        1. 端系统（主机）

        2. 客户/服务器模式

        3. 对等peer-peer模式

    2. 网络核心：互连的路由器、网络的网络

        1. 电路交换：端到端的资源分配、网络资源被分成片（统计多路复用（FDM、TDM））

        2. 分组交换：以分组为单位，存储-转发方式；资源共享，按需使用

        3. 关键功能：路由、转发（数据报网络（类似问路）、虚电路网络（带标签，保持路径））

    3. 接入网、物理媒体：有线或无线通信链路

        1. 住宅接入（modem）网络、企业接入网络、无线接入网络

        2. 物理媒体：同轴电缆、光纤、无线链路（地面微波、LAN、wide-aera、卫星）

3. 分组延时、丢失和吞吐量

    1. 分组延时：节点处理延时、排队延时、传输延时、传播延时

        1. 传输时延：发送整个分组所需时间，与分组长度和链路传输速率相关

        2. 传播时延：发送一个比特所需时间，与链路长度有关

    2. 分组丢失：队列缓冲区容量有限，队列满时分组丢失、丢失的分组可能由上一节点或源端重传，也可能不重传

    3. 瞬间吞吐量/平均吞吐量

4. 协议层次及服务模型

    1. 服务和服务访问点(SAP)

    2. 服务类型：面向连接和无连接

    3. 服务和协议：本层协议靠下层提供的服务来实现，本层实体通过协议为上层提供服务

    4. 数据单元

5. Internet协议栈

    1. 应用层：FTP/SMTP/HTTP/DNS...（报文message）

    2. 传输层：TCP/UDP（报文段segment）

    3. 网络层：IP/路由协议（分组packet/datagram）

    4. 链路层：PPP/802.11/Ethernet（帧frame）

    5. 物理层：传输bit（位bit） 

# 第二章 应用层

1. 体系结构

    1. 客户-服务器（C/S）模式

    2. 对等模式（P2P：peer To Peer）

    3. 混合体

2. 分布式进程通信

    1. 对进程进行编址：IP + Port

    2. TCP Socket：一个整数本地标示，代表一个四元组（源IP/源端口/目标IP/目标端口）

    3. UDP Socket：本地IP + 本地Port，发送报文时要指定对方的IP和UDP Port

3. Web Http

    1. URL格式：协议名 + 用户名：口令 + 主机名 + 路径名 + 端口

    2. HTTP概况

        1. 使用TCP，默认端口80

        2. HTTP是无状态的，服务器不维护关于客户的信息

        3. 非持久HTTP/持久HTTP

            1. HTTP1.0使用非持久连接，HTTP1.1默认使用持久连接

            2. 持久HTTP（非流水式：一次只有一个请求，前一个响应后发出新请求 / 流水式：同时请求）

        4. HTTP请求报文

            1. 请求行（GET / POST / HEAD） + PUT/DELETE(HTTP1.1)

            2. + 首部行（Host / User-agent / Connection / Accept-language）

            3. + 实体部分

        5. HTTP响应报文

            1. 状态行（协议版本、状态码、相应状态信息）

                1. 状态码：200(OK) / 301(Moved Permanently) / 400(Bad Request) / 404(Not Foune) / 505(HTTP Version Not Supported)

            2. 首部行

            3. 数据

        6. 使用Cookies维护用户-服务器状态

        7. Web缓存：不访问原始服务器，满足客户的请求

        8. 条件GET方法：如果缓存器中的对象是最新的（请求时 + 最后修改时间），则不发送对象

4. FTP：文件传输协议

    1. 控制连接：带外传送

    2. 使用TCP传输协议

    3. 服务器维护用户状态信息

5. Email

    1. SMTP(push)

        1. 3个阶段：握手、传输报文、关闭

        2. 持久连接

        3. 报文格式：首部行(To: / From: / Subject:) + 主体（ASCII字符）

        4. MIME：多媒体邮件拓展

    2. POP3（邮局访问协议）(pull)

        1. 用户确认阶段

        2. 事务处理阶段

    3. IMAP

6. DNS

    1. 目的：实现主机名-IP地址的转换

    2. 主要思路：分层的、分布式的、运行在UDP的53号端口上、以应用层协议实现

    3. RR格式：Domain_name、TTL、Class、Value、Type

    4. 递归查询、迭代查询

    5. DNS协议：查询和相应报文的报文格式相同，通过标志位区分

7. P2P应用

    1. 问题：如何定位所需资源、如何处理peer的加入与离开

    2. 集中式目录：单点故障、性能瓶颈、侵犯版权

    3. 查询泛洪：Gnutella(ping-pong)

    4. KaZaA：组长跟踪所有组员，与其他组长联系；使用hash值查询

    5. BitTorrent
        
        1. tracker跟踪参与节点
        
        2. Torrent节点的组，之间交换文件块

        3. 稀缺优先、有限疏通

    6. DHT(Distributed Hash Table)结构化P2P

8. CDN(Content Distribution Networks)

    1. 多媒体流化服务(DASH: Dynamic Adaptive Streaming over HTTP)

9. TCP套接字编程

    1. 服务器：创建、捆绑、等待连接

    2. 客户端：创建（隐式捆绑）、连接

    3. 服务器接受连接 -> 建立TCP连接


10. UDP套接字编程